(function(t){function e(e){for(var a,i,o=e[0],c=e[1],l=e[2],u=0,d=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&d.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);f&&f(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},s={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dafsmGraph/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var f=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"077d":function(t,e,n){"use strict";n("1ca9")},"1ca9":function(t,e,n){},5606:function(t,e,n){var a=n("278c").default;n("4fad"),n("99af"),n("b0c0"),t.exports={build:function(t){var e="",n="\n        const fsmLogic = require('./manual.json');\n        const { serviceContent, serviceDeploy } = require('@vcomm/asmcore');";console.log("Logic:",JSON.stringify(t));try{n+="\n            class serviceManager extends serviceDeploy {\n                constructor() {\n                    super();\n                }            \n            ";for(var s=0,r=Object.entries(t["states"]);s<r.length;s++)for(var i=a(r[s],2),o=i[0],c=i[1],l=0,f=Object.entries(c["transitions"]);l<f.length;l++){var u=a(f[l],2),d=u[0],p=u[1];console.log("State[".concat(o,"]->Trans[").concat(d,"]"),p),e+="this.emitOn('".concat(p.output,"',[(cntx)=>cntx.setState(cntx.getNextSate()),(cntx)=>cntx.unlock()],this.content);")}n+="initLogic() { ".concat(e," }"),n+="}"}catch(h){console.fatal("Build body node.js template: in ".concat(t["id"]," >")+h.name+":"+h.message+"\n"+h.stack)}finally{return n}}}},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),s={id:"app"};function r(t,e,n,r,i,o){var c=Object(a["j"])("Graph");return Object(a["f"])(),Object(a["c"])("div",s,[Object(a["e"])(c)])}n("99af");var i=Object(a["o"])("data-v-f7d7e86e");Object(a["h"])("data-v-f7d7e86e");var o={class:"dropdown"},c=Object(a["e"])("button",{class:"btn"},[Object(a["d"])("[ File ] "),Object(a["e"])("i",{class:"fa fa-caret-down"})],-1),l={class:"dropdown-content"},f=Object(a["e"])("i",{class:"fas fa-folder-plus"},null,-1),u=Object(a["d"])(" New"),d=Object(a["e"])("i",{class:"fas fa-folder-open"},null,-1),p=Object(a["d"])(" Open"),h=Object(a["e"])("i",{class:"fas fa-save"},null,-1),b=Object(a["d"])(" Save"),O={class:"dropdown"},y=Object(a["e"])("button",{class:"btn"},[Object(a["d"])("[ Build ] "),Object(a["e"])("i",{class:"fa fa-caret-down"})],-1),m={class:"dropdown-content"},g=Object(a["e"])("i",{class:"fas fa-code"},null,-1),j=Object(a["d"])(" Execute JSON"),v=Object(a["e"])("i",{class:"fab fa-node-js"},null,-1),k=Object(a["d"])(" Code Template"),w=Object(a["e"])("i",{class:"fas fa-project-diagram"},null,-1),S=Object(a["d"])(" State"),x=Object(a["e"])("i",{class:"fas fa-exchange-alt"},null,-1),N=Object(a["d"])(" Trans"),T={class:"dropdown"},J={class:"btn"},C=Object(a["d"])("[ "),P={ref:"more"},M=Object(a["d"])(" ] "),A=Object(a["e"])("i",{class:"fa fa-caret-down"},null,-1),D={class:"dropdown-content"},R=Object(a["e"])("i",{class:"fas fa-project-diagram"},null,-1),E=Object(a["d"])(" new State"),$=Object(a["e"])("i",{class:"fas fa-exchange-alt"},null,-1),_=Object(a["d"])(" new Trans"),G=Object(a["e"])("i",{class:"fas fa-list"},null,-1),F=Object(a["d"])(" Export Graph"),L=Object(a["e"])("i",{class:"fas fa-trash"},null,-1),z=Object(a["d"])(" del State"),U=Object(a["e"])("i",{class:"fas fa-sign-in-alt"},null,-1),V=Object(a["d"])(" add Entry"),q=Object(a["e"])("i",{class:"fas fa-sign-out-alt"},null,-1),B=Object(a["d"])(" add Exit"),I=Object(a["e"])("i",{class:"fas fa-recycle"},null,-1),W=Object(a["d"])(" add Stay"),H=Object(a["e"])("i",{class:"fas fa-trash"},null,-1),K=Object(a["d"])(" del Trans"),Q=Object(a["e"])("i",{class:"fas fa-bolt"},null,-1),X=Object(a["d"])(" add Trigger"),Y=Object(a["e"])("i",{class:"fab fa-buffer"},null,-1),Z=Object(a["d"])(" add Effect"),tt={class:"container",ref:"joint"},et={id:"dialog",class:"modal",ref:"dialog"},nt={class:"modal-dialog"},at={class:"modal-content"},st={id:"State",ref:"State",style:{display:"none"}},rt=Object(a["e"])("p",null,null,-1),it=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Type: ")],-1),ot=Object(a["d"])("Start "),ct=Object(a["d"])("End "),lt=Object(a["d"])("Regular "),ft={class:"fas fa-palette fa-2x",style:{color:"red"},ref:"palette",title:"click for change color"},ut={id:"Trans",ref:"Trans",style:{display:"none"}},dt=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Trigger Name: ")],-1),pt=Object(a["e"])("p",null,null,-1),ht=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Effect Name: ")],-1),bt={autofocus:"autofocus",class:"modal-enter",ref:"effectName",type:"text"},Ot=Object(a["e"])("p",null,null,-1),yt=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Transition Src: ")],-1),mt=Object(a["e"])("p",null,null,-1),gt=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Transition Dst: ")],-1),jt=Object(a["e"])("p",null,null,-1),vt={id:"Action",ref:"Action",style:{display:"none"}},kt={autofocus:"autofocus",class:"modal-enter",id:"actionName",ref:"actionName",placeholder:"choose a action name",type:"text"};Object(a["g"])();var wt=i((function(t,e,n,s,r,i){return Object(a["f"])(),Object(a["c"])("div",null,[Object(a["e"])("nav",null,[Object(a["e"])("div",o,[c,Object(a["e"])("div",l,[Object(a["e"])("a",{href:"#",onClick:e[1]||(e[1]=function(t){return i.newGraph()})},[f,u]),Object(a["e"])("a",{href:"#",onClick:e[2]||(e[2]=function(t){return i.openGraph()})},[d,p]),Object(a["e"])("a",{href:"#",onClick:e[3]||(e[3]=function(t){return i.saveGraph()})},[h,b])])]),Object(a["e"])("div",O,[y,Object(a["e"])("div",m,[Object(a["e"])("a",{href:"#",onClick:e[4]||(e[4]=function(t){return i.execJSON()})},[g,j]),Object(a["e"])("a",{href:"#",onClick:e[5]||(e[5]=function(t){return i.nodejsCODE()})},[v,k])])]),Object(a["e"])("button",{class:"btn",onClick:e[6]||(e[6]=function(t){return i.showModal("State")})},[w,S]),Object(a["e"])("button",{class:"btn",onClick:e[7]||(e[7]=function(t){return i.showModal("Trans")})},[x,N]),Object(a["e"])("div",T,[Object(a["e"])("button",J,[C,Object(a["e"])("b",P,"Paper",512),M,A]),Object(a["e"])("div",D,[Object(a["e"])("a",{href:"#",class:"paper",onClick:e[8]||(e[8]=function(t){return i.showModal("State")})},[R,E]),Object(a["e"])("a",{href:"#",class:"paper",onClick:e[9]||(e[9]=function(t){return i.showModal("Trans")})},[$,_]),Object(a["e"])("a",{href:"#",class:"paper",onClick:e[10]||(e[10]=function(t){return i.graphExport()})},[G,F]),Object(a["e"])("a",{href:"#",class:"state",style:{display:"none"},onClick:e[11]||(e[11]=function(t){return i.sellRemove()})},[L,z]),Object(a["e"])("a",{href:"#",class:"state init",style:{display:"none"},onClick:e[12]||(e[12]=function(t){return i.showModal("Action","entries")})},[U,V]),Object(a["e"])("a",{href:"#",class:"state final",style:{display:"none"},onClick:e[13]||(e[13]=function(t){return i.showModal("Action","exits")})},[q,B]),Object(a["e"])("a",{href:"#",class:"state init final",style:{display:"none"},onClick:e[14]||(e[14]=function(t){return i.showModal("Action","stays")})},[I,W]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:e[15]||(e[15]=function(t){return i.sellRemove()})},[H,K]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:e[16]||(e[16]=function(t){return i.showModal("Action","triggers")})},[Q,X]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:e[17]||(e[17]=function(t){return i.showModal("Action","effects")})},[Y,Z])])])]),Object(a["e"])("div",tt,null,512),Object(a["e"])("div",et,[Object(a["e"])("div",nt,[Object(a["e"])("div",at,[Object(a["e"])("span",{id:"closeModal",class:"close",onClick:e[18]||(e[18]=function(t){return i.hideModal()})},"Ã—"),Object(a["e"])("div",st,[Object(a["e"])("input",{autofocus:"autofocus",class:"modal-enter",id:"stateName",ref:"stateName",placeholder:["initialState"===r.stateType?"init":"finalState"===r.stateType?"final":"choose a state name"],type:"text"},null,8,["placeholder"]),Object(a["e"])("button",{id:"confirmState",class:"modal-enter",onClick:e[19]||(e[19]=function(t){return i.newState()})},"Confirm"),rt,it,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"initialState","onUpdate:modelValue":e[20]||(e[20]=function(t){return r.stateType=t})},null,512),[[a["l"],r.stateType]]),ot,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"finalState","onUpdate:modelValue":e[21]||(e[21]=function(t){return r.stateType=t})},null,512),[[a["l"],r.stateType]]),ct,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"regularState","onUpdate:modelValue":e[22]||(e[22]=function(t){return r.stateType=t}),checked:""},null,512),[[a["l"],r.stateType]]),lt,Object(a["e"])("span",{onClick:e[23]||(e[23]=function(t){return i.selColor()}),style:{"margin-left":"70px"}},[Object(a["e"])("i",ft,null,512)])],512),Object(a["e"])("div",ut,[dt,Object(a["e"])("input",{autofocus:"autofocus",class:"modal-enter",ref:"transName",placeholder:"".concat(r.transSrc,"=>T=>").concat(r.transDst),type:"text"},null,8,["placeholder"]),pt,ht,Object(a["e"])("input",bt,null,512),Ot,yt,Object(a["n"])(Object(a["e"])("select",{id:"fromState","onUpdate:modelValue":e[24]||(e[24]=function(t){return r.transSrc=t}),class:"modal-enter"},[(Object(a["f"])(!0),Object(a["c"])(a["a"],null,Object(a["i"])(r.srcOptions,(function(t){return Object(a["f"])(),Object(a["c"])("option",{key:t.id,value:t.value},Object(a["k"])(t.text),9,["value"])})),128))],512),[[a["m"],r.transSrc]]),mt,gt,Object(a["n"])(Object(a["e"])("select",{id:"toState","onUpdate:modelValue":e[25]||(e[25]=function(t){return r.transDst=t}),class:"modal-enter"},[(Object(a["f"])(!0),Object(a["c"])(a["a"],null,Object(a["i"])(r.dstOptions,(function(t){return Object(a["f"])(),Object(a["c"])("option",{key:t.id,value:t.value},Object(a["k"])(t.text),9,["value"])})),128))],512),[[a["m"],r.transDst]]),jt,Object(a["e"])("button",{id:"confirmTrans",class:"modal-enter",onClick:e[26]||(e[26]=function(t){return i.newTrans()})},"Confirm")],512),Object(a["e"])("div",vt,[Object(a["e"])("input",kt,null,512),Object(a["e"])("button",{id:"confirmAction",class:"modal-enter",onClick:e[27]||(e[27]=function(t){return i.newAction()})},"Confirm")],512)])]),Object(a["e"])("input",{id:"projectinput",ref:"projectinput",onChange:e[28]||(e[28]=function(t){return i.onLoad(t)}),type:"file",style:{display:"none"}},null,544)],512)])})),St=n("3835"),xt=n("1da1"),Nt=(n("96cf"),n("a434"),n("b0c0"),n("159b"),n("d3b7"),n("ddb0"),n("4fad"),n("8ae0")),Tt=(n("1646"),n("d4ec")),Jt=n("bee2"),Ct=(n("7db0"),function(){function t(e,n){Object(Tt["a"])(this,t),this.pattern=n?{name:e,func:n}:{name:e}}return Object(Jt["a"])(t,[{key:"get",value:function(){return this.pattern}},{key:"addfunc",value:function(t){this.pattern.func=t}}]),t}()),Pt=function(){function t(e,n,a){Object(Tt["a"])(this,t),this.pattern=a||{key:e,nextstatename:n,triggers:[],effects:[]}}return Object(Jt["a"])(t,[{key:"get",value:function(){return this.pattern}},{key:"addtrigger",value:function(t,e){this.pattern.triggers.push(new Ct(t,e).get())}},{key:"addeffect",value:function(t,e){this.pattern.effects.push(new Ct(t,e).get())}}]),t}(),Mt=function(){function t(e,n,a){switch(Object(Tt["a"])(this,t),this.transDict={},this.pattern={key:e,name:n},a){case"initialState":this.pattern.key="init",this.pattern.exits=[],this.pattern.transitions=[];break;case"finalState":this.pattern.entries=[];break;default:this.pattern.entries=[],this.pattern.stays=[],this.pattern.exits=[],this.pattern.transitions=[]}}return Object(Jt["a"])(t,[{key:"get",value:function(){return this.pattern}},{key:"setsuperstate",value:function(t){this.pattern.superstate={link:t}}},{key:"addentry",value:function(t,e){if(this.pattern.hasOwnProperty("entries")){var n=this.pattern.entries.find((function(e){return e.name==t}));if(void 0===n){var a=new Ct(t,e);return this.pattern.entries.push(a.get()),a}return n.func=e,null}return null}},{key:"addexit",value:function(t,e){if(this.pattern.hasOwnProperty("exits")){var n=new Ct(t,e);return this.pattern.exits.push(n.get()),n}return null}},{key:"addstay",value:function(t,e){if(this.pattern.hasOwnProperty("stays")){var n=new Ct(t,e);return this.pattern.stays.push(n.get()),n}return null}},{key:"addtrans",value:function(t,e,n){if(this.pattern.hasOwnProperty("transitions")){var a=new Pt(t,e,n);return this.pattern.transitions.push(a.get()),this.transDict[t]=a,a}return null}},{key:"deltrans",value:function(t){if(this.pattern.hasOwnProperty("transitions"))for(var e=this.get().transitions,n=0;n<e.length;n++){var a=e[n];if(a.key===t)return e.splice(n,1),this.transDict.hasOwnProperty(t)&&delete this.transDict[t],!0}return!1}},{key:"clonetrans",value:function(t){if(this.pattern.hasOwnProperty("transitions")){var e=new Pt("","",JSON.parse(JSON.stringify(t)));return this.pattern.transitions.push(e.get()),e}return null}}]),t}(),At=function(){function t(e,n){Object(Tt["a"])(this,t),this.pattern={id:e,type:"FSM",prj:n,complete:!1,start:{},stop:{},countstates:0,states:{}},this.statesDict={},this.stroke=["#d0c4f4","#f46b6d","#5d8dbe","#F4D03F","#66bc84","#e6b362","#80c5e2"]}return Object(Jt["a"])(t,[{key:"reset",value:function(){this.pattern.start={},this.pattern.stop={},this.pattern.countstates=0,this.pattern.states={},this.statesDict={}}},{key:"get",value:function(){return this.pattern}},{key:"addstate",value:function(t,e,n){var a=new Mt(t,e,n);return this.pattern.states[t]=a.get(),this.pattern.countstates++,this.statesDict[t]=a,a}},{key:"delstate",value:function(t){this.pattern.states.hasOwnProperty(t)&&(delete this.pattern.states[t],this.pattern.countstates--,this.statesDict.hasOwnProperty(t)&&delete this.statesDict[t])}},{key:"addstart",value:function(t,e){this.pattern.start=new Ct(t,e).get()}},{key:"addstop",value:function(t,e){this.pattern.stop=new Ct(t,e).get()}},{key:"genColor",value:function(){for(var t="0123456789ABCDEF",e="#",n=0;n<6;n++)e+=t[Math.floor(16*Math.random())];return e}}]),t}(),Dt=n("21a6"),Rt=n.n(Dt),Et=function(){function t(e){Object(Tt["a"])(this,t),this._prjname_=e||"project",this._extension_="dafsm"}return Object(Jt["a"])(t,[{key:"read",value:function(t,e){var n=new FileReader;n.readAsText(t),n.onload=function(){console.log(n.result),e&&e(n.result)},n.onerror=function(){console.log(n.error)}}},{key:"save",value:function(t,e){var n=e||"".concat(this._prjname_,".").concat(this._extension_),a=new File([t],n,{type:"text/plain;charset=utf-8"});Rt.a.saveAs(a)}}]),t}(),$t=n("c484"),_t=n.n($t),Gt=n("5606"),Ft=n.n(Gt),Lt={name:"Graph",data:function(){return{uml:Nt["b"].uml,selected:null,fsaJSON:new At("tst","prj"),fsaPROJ:new Et("myproj"),stateType:"regularState",transSrc:void 0,srcOptions:[],transDst:void 0,dstOptions:[]}},created:function(){var t=this;this.graph=new Nt["a"].Graph({},{cellNamespace:Nt["b"]}),this.graph.on("remove",(function(e){var n=t.fsaJSON.get();switch(e.fsa.type){case"trans":var a=e.fsa.owner.pattern,s=e.fsa.item.get().key;if(console.log("Remove from Owner ".concat(JSON.stringify(e.fsa.owner)," Transition: ").concat(JSON.stringify(e.fsa.item.get()))),e.fsa.owner.deltrans(e.fsa.item.get().key),n.states.hasOwnProperty(a.key)&&n.states[a.key].hasOwnProperty("transitions"))for(var r=n.states[a.key].transitions,i=0;i<r.length;i++){var o=r[i];o.key===s&&r.splice(i,1)}break;case"state":var c=e.fsa.item.get().key;console.log("Remove State: ",e.fsa.item.get()),t.fsaJSON.delstate(c),n.states.hasOwnProperty(c)&&delete n.states[c];break}})),this.graph.on("change:source",(function(e){e.attributes.source.id&&t.changeTransSrc(e)})),this.graph.on("change:target",(function(e){t.changeTransDst(e)}))},mounted:function(){var t=this,e=this;this.paper=new Nt["a"].Paper({el:this.$refs.joint,width:this.$refs.joint.clientWidth,height:this.$refs.joint.clientHeight,gridSize:1,model:this.graph,cellViewNamespace:Nt["b"],snapLabels:!0,interactive:{linkMove:!0,labelMove:!0,arrowheadMove:!0,vertexMove:!0,vertexAdd:!0,vertexRemove:!0,useLinkTools:!0}}),this.paper.on("cell:pointerdown",(function(n){e.selected&&e.selected.attr({rect:{fill:"rgba(48, 208, 198, 0.1)"},text:{fill:"black","font-size":15}}),n.model.attr({rect:{fill:"yellow"},text:{fill:"black","font-size":15}}),e.selected=n.model,"state"===e.selected.fsa.type?(t.$refs.more.innerText="State",e.showhide([".state"],[".paper",".trans"]),"init"===e.selected.fsa.item.pattern.key&&e.showhide([],[".init"]),"final"===e.selected.fsa.item.pattern.key&&e.showhide([],[".final"])):"trans"===e.selected.fsa.type?(t.$refs.more.innerText="Trans",e.showhide([".trans"],[".paper",".state"])):e.showhide([],[".paper",".state",".trans"]),console.log("selected "+e.selected.fsa.type,e.selected.fsa.item)})),this.paper.on("blank:pointerdown",(function(){e.selected&&(e.selected.attr({rect:{fill:"rgba(48, 208, 198, 0.1)"},text:{fill:"black","font-size":15}}),e.selected=null,e.showhide([".paper"],[".state",".trans"]),console.log("Reset All"),t.$refs.more.innerText="Paper")})),this.paper.on("cell:pointerclick",(function(t,e,n,a){console.log("cell:pointerclick - x[".concat(n,"], y[").concat(a,"]"))})),this.paper.on("cell:pointerdblclick",(function(t){console.log("Show State:",t.model.fsa.item.get())})),this.paper.on("element:contextmenu",(function(t){console.log("Rigth Click Context Menu:")}))},watch:{},computed:{},methods:{graphExport:function(){return Object(xt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},execJSON:function(){var t=this;return Object(xt["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"test",n=_t.a.build(t.fsaJSON.get()),console.log("Execute JSON:",n),t.fsaPROJ.save(JSON.stringify(n),"exec.json");case 4:case"end":return e.stop()}}),e)})))()},nodejsCODE:function(){var t=this;return Object(xt["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"test",n=Ft.a.build(_t.a.build(t.fsaJSON.get())),console.log("Node.js code template:",n),t.fsaPROJ.save(n,"code.js");case 4:case"end":return e.stop()}}),e)})))()},selColor:function(){var t=this.fsaJSON.genColor();console.log("Color:",t),this.$refs.palette.style.color=t},genColor:function(){return this.fsaJSON.genColor()},newGraph:function(){this.graph.clear(),this.fsaJSON.reset(),console.log("Start new graph")},openGraph:function(){this.$refs.projectinput.click()},onLoad:function(t){var e=this,n=t.target.files[0];console.log("Load Project File: ".concat(n.name,", size: ").concat(n.size)),this.fsaPROJ.read(n,(function(t){var n=JSON.parse(t);console.debug("Read Project: ",n),e.restoreGraph(n.states)}))},saveGraph:function(){this.fsaPROJ.save(JSON.stringify(this.fsaJSON.get()))},getSelectedItem:function(){return this.selected?{type:this.selected.fsa.type,name:this.selected.fsa.item.pattern.key}:null},sellRemove:function(){this.selected&&this.selected.remove()},showhide:function(t,e){t.forEach((function(t,e,n){var a=document.querySelectorAll(t);for(e=0;e<a.length;e++)a[e].style.display="block"})),e.forEach((function(t,e,n){var a=document.querySelectorAll(t);for(e=0;e<a.length;e++)a[e].style.display="none"}))},showDAFSM:function(){console.log("DAFSM:",this.fsaJSON.get());var t=window.open("_blank");t.document.write(JSON.stringify(this.fsaJSON.get()))},showModal:function(t,e){this.$refs.dialog.style.display="block",this.$refs[t].style.display="block",this.actionType=e,this.updateStateList()},hideModal:function(){this.$refs["State"].style.display="none",this.$refs["Trans"].style.display="none",this.$refs["Action"].style.display="none",this.$refs.dialog.style.display="none"},updateStateList:function(){for(var t in this.srcOptions=[],this.dstOptions=[],this.fsaJSON.get().states)console.log("Update state list",t),this.srcOptions.push({id:t,text:t,value:t}),this.dstOptions.push({id:t,text:t,value:t})},newAction:function(){var t=this.$refs.actionName.value;this.addAction(this.actionType,t),this.hideModal()},newState:function(){var t=this.stateType,e="initialState"===this.stateType?"init":"finalState"===this.stateType?"final":this.$refs.stateName.value;if(console.log("New State: ".concat(e," [").concat(t,"]")),this.fsaJSON.get().states[e])return this.$refs.stateName.value="",this.$refs.stateName.setAttribute("placeholder","state[ "+e+"] exist - choose other name"),void console.log("state[ "+e+"] exist - choose other name");this.makeState(t,e),this.hideModal()},makeState:function(t,e){var n=this.uml,a=this.fsaJSON.get(),s=null,r=null,i=10*a.countstates;switch(t){case"initialState":s=new n.StartState({position:{x:150,y:20},size:{width:30,height:30},attrs:{circle:{fill:"#4b4a67",stroke:"none"}}}),r=this.fsaJSON.addstate("init","init",t),a["states"]["init"]=r.pattern;break;case"finalState":s=new n.EndState({position:{x:750,y:550},size:{width:30,height:30},attrs:{".outer":{stroke:"#4b4a67","stroke-width":2},".inner":{fill:"#4b4a67"}}}),r=this.fsaJSON.addstate("final","final",t),a["states"]["final"]=r.pattern;break;default:var o=this.$refs.palette.style.color;s=new n.State({position:{x:500+i,y:50+i},size:{width:150,height:80},name:e,events:['{"entries":0}','{"stays":0}','{"exits":0}'],attrs:{".uml-state-body":{fill:"rgba(48, 208, 198, 0.1)",stroke:o,"stroke-width":3},".uml-state-separator":{stroke:o}}}),r=this.fsaJSON.addstate(e,e,t),a["states"][e]=r.pattern}r.get().model=s,s.fsa={type:"state",item:r},this.graph.addCell(s),console.log("".concat(e,"[").concat(s.id,"]"),s)},newTrans:function(){var t=void 0;if(!this.transSrc||!this.transDst)return this.$refs.transName.value="",this.$refs.transName.setAttribute("placeholder","please select transition source & destination"),void console.log("please fill all fields and select side");this.transSrc===this.transDst&&(t=[{x:513,y:309},{x:637,y:308},{x:636,y:221}]);var e=this.$refs.transName.value,n=this.$refs.effectName.value;this.makeTrans(this.transSrc,this.transDst,e,n,t),this.hideModal()},makeTrans:function(t,e,n,a,s){var r=this.uml,i=this.fsaJSON.get(),o="".concat(t,"=>[").concat(n,"/").concat(a,"]=>").concat(e),c=i.states[t],l=i.states[e],f=n?"".concat(n,"/").concat(a):o,u=new r.Transition({source:{id:c.model.id},target:{id:l.model.id},attrs:{".connection":{fill:"none","stroke-linejoin":"round","stroke-width":"2",stroke:"init"===t?"#4b4a67":c.model.attributes.attrs[".uml-state-body"].stroke},".marker-arrowheads":{display:"none"}},labels:[{position:{distance:.5,offset:f.indexOf("\n")>-1||1===f.length?0:10,args:{keepGradient:!0,ensureLegibility:!0}},attrs:{text:{text:f,fontWeight:"bold"}}}],vertices:s||[]}),d=c.model.fsa.item.addtrans(o,l.key);n&&d.addtrigger(n,""),a&&d.addeffect(a,""),d.get().model=u,u.fsa={type:"trans",item:d,owner:c.model.fsa.item},this.graph.addCell(u),console.log("".concat(t,"[").concat(c.model.id,"] => ").concat(e,"[").concat(l.model.id,"]"),u)},addAction:function(t,e,n){var a=this.getSelectedItem();if(a){var s=this.selected.fsa.item;switch(a.type){case"state":var r=this.selected.get("events");switch(t){case"entries":if(r){var i=JSON.parse(r[0]);i.entries++,this.selected.set("events",[JSON.stringify(i),r[1],r[2]])}s.addentry(e,n||"return");break;case"stays":if(r){var o=JSON.parse(r[1]);o.stays++,this.selected.set("events",[r[0],JSON.stringify(o),r[2]])}s.addstay(e,n||"return");break;case"exits":if(r){var c=JSON.parse(r[2]);c.exits++,this.selected.set("events",[r[0],r[1],JSON.stringify(c)])}s.addexit(e,n||"return");break}break;case"trans":switch(t){case"triggers":s.addtrigger(e,n||"return true");break;case"effects":s.addeffect(e,n||"return");break}break}}},changeTransDst:function(t){if(t.attributes.target.id){var e=t.attributes.target.id,n=t.graph.getCell(e);t.fsa.item.pattern.key="T:".concat(t.fsa.owner.pattern.key,"=>").concat(n.fsa.item.pattern.key),t.fsa.item.pattern.nextstatename=n.fsa.item.pattern.key,console.log("target of the link changed to ".concat(t.fsa.item.pattern.nextstatename,":"),t,n),console.log("updated FSA",this.get().states)}},changeTransSrc:function(t){var e=t.attributes.source.id,n=t.graph.getCell(e),a=t.fsa.owner.pattern.key,s=n.fsa.item.pattern.key;if(a!==s){var r=this.get().states[a],i=this.get().states[s],o=t.fsa.item.pattern.key,c=r.model.fsa.item.deltrans(o);Array.isArray(c)?(c=c[0],c.key="T:".concat(s,"=>").concat(t.fsa.item.pattern.nextstatename),i.model.fsa.item.clonetrans(c),t.fsa.item.pattern.key=c.key,t.fsa.owner=i.model.fsa.item,console.log("source of the link changed and updated FSA",this.get().states)):(t.remove(),console.log("source of the link changed failed, was deleted",this.get().states))}},restoreState:function(t){var e=this.uml,n={StartState:function(t,n){var s=new e.StartState(t.model),r=n.fsaJSON.addstate("init",t.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s},EndState:function(t,n){var s=new e.EndState(t.model),r=n.fsaJSON.addstate("final",t.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s},State:function(t,n){var s=new e.State(t.model),r=n.fsaJSON.addstate(t.key,t.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s}},a=t.model.type.substring(t.model.type.indexOf(".")+1);console.log("Restore State: ",t.model),this.graph.addCell(n[a](t,this))},restoreTrans:function(t,e,n,a){var s=this.uml,r=new s.Transition(t),i=e.addtrans(a,n);return i.get().model=r,r.fsa={type:"trans",item:i,owner:e},console.log("Restore Trans: ",t),this.graph.addCell(r),i},restoreGraph:function(t){var e=this;if(t instanceof Object){for(var n=0,a=Object.entries(t);n<a.length;n++){var s=Object(St["a"])(a[n],2),r=(s[0],s[1]);r.hasOwnProperty("model")&&this.restoreState(r)}for(var i=function(){var t=Object(St["a"])(c[o],2),n=(t[0],t[1]);n&&n.hasOwnProperty("transitions")&&n.transitions.forEach((function(t){var a=e.fsaJSON.statesDict[n.key],s=a.addtrans(t.key,t.nextstatename,t);if(t.hasOwnProperty("model")){var r=new e.uml.Transition(t.model);r.fsa={type:"trans",item:s,owner:a},e.graph.addCell(r)}}))},o=0,c=Object.entries(t);o<c.length;o++)i()}else console.warn("Cannon Restore old style format")}}};n("a8a3");Lt.render=wt,Lt.__scopeId="data-v-f7d7e86e";var zt=Lt,Ut={name:"App",components:{Graph:zt}};n("077d");Ut.render=r;var Vt=Ut;Object(a["b"])(Vt).mount("#app")},a8a3:function(t,e,n){"use strict";n("e259")},c484:function(t,e,n){var a=n("278c").default;function s(t){var e={};return t&&t.hasOwnProperty("transitions")&&t.transitions.forEach((function(t){e[t.key]={nextstatename:t.nextstatename},console.log("Trans[".concat(t.key,"]:"),t),t.hasOwnProperty("triggers")&&t.triggers.forEach((function(n){e[t.key].input=n.name})),t.hasOwnProperty("effects")&&t.effects.forEach((function(n){e[t.key].output=n.name}))})),e}function r(t,e){t.forEach((function(t){e[key]={key:key,transitions:s(t)}}))}function i(t,e){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=a(r[n],2),o=i[0],c=i[1];e[o]={key:o,transitions:s(c)}}}n("159b"),n("b0c0"),n("4fad"),t.exports={build:function(t){var e={id:t.id,prj:t.prj,states:{}};try{var n=t["states"];n instanceof Array?r(n,e["states"]):n instanceof Object?i(n,e["states"]):console.error("Not compatible States")}catch(a){console.fatal("Build Execute JSON ERROR: in ".concat(t["id"]," >")+a.name+":"+a.message+"\n"+a.stack)}finally{return e}}}},e259:function(t,e,n){}});
//# sourceMappingURL=app.36e1cd93.js.map