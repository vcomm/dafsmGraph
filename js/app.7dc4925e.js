(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],u=0,d=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&d.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(t);while(d.length)d.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dafsmGraph/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var f=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"077d":function(e,t,n){"use strict";n("1ca9")},"1ca9":function(e,t,n){},"3cde":function(e,t,n){"use strict";n("7c2c")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),s={id:"app"};function r(e,t,n,r,i,o){var c=Object(a["j"])("Graph");return Object(a["f"])(),Object(a["c"])("div",s,[Object(a["e"])(c)])}n("99af");var i=Object(a["o"])("data-v-d4b613a0");Object(a["h"])("data-v-d4b613a0");var o={class:"dropdown"},c=Object(a["e"])("button",{class:"btn"},[Object(a["d"])("[ File ] "),Object(a["e"])("i",{class:"fa fa-caret-down"})],-1),l={class:"dropdown-content"},f=Object(a["e"])("i",{class:"fas fa-folder-plus"},null,-1),u=Object(a["d"])(" New"),d=Object(a["e"])("i",{class:"fas fa-folder-open"},null,-1),p=Object(a["d"])(" Open"),h=Object(a["e"])("i",{class:"fas fa-save"},null,-1),b=Object(a["d"])(" Save"),O={class:"dropdown"},y=Object(a["e"])("button",{class:"btn"},[Object(a["d"])("[ Build ] "),Object(a["e"])("i",{class:"fa fa-caret-down"})],-1),m={class:"dropdown-content"},g=Object(a["e"])("i",{class:"fas fa-code"},null,-1),j=Object(a["d"])(" Execute JSON"),v=Object(a["e"])("i",{class:"fab fa-node-js"},null,-1),w=Object(a["d"])(" Code Template"),k=Object(a["e"])("i",{class:"fas fa-project-diagram"},null,-1),S=Object(a["d"])(" State"),x=Object(a["e"])("i",{class:"fas fa-exchange-alt"},null,-1),N=Object(a["d"])(" Trans"),T={class:"dropdown"},C={class:"btn"},J=Object(a["d"])("[ "),P={ref:"more"},M=Object(a["d"])(" ] "),A=Object(a["e"])("i",{class:"fa fa-caret-down"},null,-1),D={class:"dropdown-content"},R=Object(a["e"])("i",{class:"fas fa-project-diagram"},null,-1),$=Object(a["d"])(" new State"),E=Object(a["e"])("i",{class:"fas fa-exchange-alt"},null,-1),_=Object(a["d"])(" new Trans"),G=Object(a["e"])("i",{class:"fas fa-list"},null,-1),F=Object(a["d"])(" Export Graph"),z=Object(a["e"])("i",{class:"fas fa-trash"},null,-1),L=Object(a["d"])(" del State"),U=Object(a["e"])("i",{class:"fas fa-sign-in-alt"},null,-1),V=Object(a["d"])(" add Entry"),I=Object(a["e"])("i",{class:"fas fa-sign-out-alt"},null,-1),q=Object(a["d"])(" add Exit"),B=Object(a["e"])("i",{class:"fas fa-recycle"},null,-1),W=Object(a["d"])(" add Stay"),H=Object(a["e"])("i",{class:"fas fa-trash"},null,-1),K=Object(a["d"])(" del Trans"),Q=Object(a["e"])("i",{class:"fas fa-bolt"},null,-1),X=Object(a["d"])(" add Trigger"),Y=Object(a["e"])("i",{class:"fab fa-buffer"},null,-1),Z=Object(a["d"])(" add Effect"),ee={class:"container",ref:"joint"},te={id:"dialog",class:"modal",ref:"dialog"},ne={class:"modal-dialog"},ae={class:"modal-content"},se={id:"State",ref:"State",style:{display:"none"}},re=Object(a["e"])("p",null,null,-1),ie=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Type: ")],-1),oe=Object(a["d"])("Start "),ce=Object(a["d"])("End "),le=Object(a["d"])("Regular "),fe={class:"fas fa-palette fa-2x",style:{color:"red"},ref:"palette",title:"click for change color"},ue={id:"Trans",ref:"Trans",style:{display:"none"}},de=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Trigger Name: ")],-1),pe=Object(a["e"])("p",null,null,-1),he=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Effect Name: ")],-1),be={autofocus:"autofocus",class:"modal-enter",ref:"effectName",type:"text"},Oe=Object(a["e"])("p",null,null,-1),ye=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Transition Src: ")],-1),me=Object(a["e"])("p",null,null,-1),ge=Object(a["e"])("label",{style:{"margin-left":"-100px"}},[Object(a["e"])("b",null,"Transition Dst: ")],-1),je=Object(a["e"])("p",null,null,-1),ve={id:"Action",ref:"Action",style:{display:"none"}},we={autofocus:"autofocus",class:"modal-enter",id:"actionName",ref:"actionName",placeholder:"choose a action name",type:"text"};Object(a["g"])();var ke=i((function(e,t,n,s,r,i){return Object(a["f"])(),Object(a["c"])("div",null,[Object(a["e"])("nav",null,[Object(a["e"])("div",o,[c,Object(a["e"])("div",l,[Object(a["e"])("a",{href:"#",onClick:t[1]||(t[1]=function(e){return i.newGraph()})},[f,u]),Object(a["e"])("a",{href:"#",onClick:t[2]||(t[2]=function(e){return i.openGraph()})},[d,p]),Object(a["e"])("a",{href:"#",onClick:t[3]||(t[3]=function(e){return i.saveGraph()})},[h,b])])]),Object(a["e"])("div",O,[y,Object(a["e"])("div",m,[Object(a["e"])("a",{href:"#",onClick:t[4]||(t[4]=function(e){return i.execJSON()})},[g,j]),Object(a["e"])("a",{href:"#",onClick:t[5]||(t[5]=function(e){return i.nodejsCODE()})},[v,w])])]),Object(a["e"])("button",{class:"btn",onClick:t[6]||(t[6]=function(e){return i.showModal("State")})},[k,S]),Object(a["e"])("button",{class:"btn",onClick:t[7]||(t[7]=function(e){return i.showModal("Trans")})},[x,N]),Object(a["e"])("div",T,[Object(a["e"])("button",C,[J,Object(a["e"])("b",P,"Paper",512),M,A]),Object(a["e"])("div",D,[Object(a["e"])("a",{href:"#",class:"paper",onClick:t[8]||(t[8]=function(e){return i.showModal("State")})},[R,$]),Object(a["e"])("a",{href:"#",class:"paper",onClick:t[9]||(t[9]=function(e){return i.showModal("Trans")})},[E,_]),Object(a["e"])("a",{href:"#",class:"paper",onClick:t[10]||(t[10]=function(e){return i.graphExport()})},[G,F]),Object(a["e"])("a",{href:"#",class:"state",style:{display:"none"},onClick:t[11]||(t[11]=function(e){return i.sellRemove()})},[z,L]),Object(a["e"])("a",{href:"#",class:"state init",style:{display:"none"},onClick:t[12]||(t[12]=function(e){return i.showModal("Action","entries")})},[U,V]),Object(a["e"])("a",{href:"#",class:"state final",style:{display:"none"},onClick:t[13]||(t[13]=function(e){return i.showModal("Action","exits")})},[I,q]),Object(a["e"])("a",{href:"#",class:"state init final",style:{display:"none"},onClick:t[14]||(t[14]=function(e){return i.showModal("Action","stays")})},[B,W]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:t[15]||(t[15]=function(e){return i.sellRemove()})},[H,K]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:t[16]||(t[16]=function(e){return i.showModal("Action","triggers")})},[Q,X]),Object(a["e"])("a",{class:"trans",href:"#",style:{display:"none"},onClick:t[17]||(t[17]=function(e){return i.showModal("Action","effects")})},[Y,Z])])])]),Object(a["e"])("div",ee,null,512),Object(a["e"])("div",te,[Object(a["e"])("div",ne,[Object(a["e"])("div",ae,[Object(a["e"])("span",{id:"closeModal",class:"close",onClick:t[18]||(t[18]=function(e){return i.hideModal()})},"Ã—"),Object(a["e"])("div",se,[Object(a["e"])("input",{autofocus:"autofocus",class:"modal-enter",id:"stateName",ref:"stateName",placeholder:["initialState"===r.stateType?"init":"finalState"===r.stateType?"final":"choose a state name"],type:"text"},null,8,["placeholder"]),Object(a["e"])("button",{id:"confirmState",class:"modal-enter",onClick:t[19]||(t[19]=function(e){return i.newState()})},"Confirm"),re,ie,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"initialState","onUpdate:modelValue":t[20]||(t[20]=function(e){return r.stateType=e})},null,512),[[a["l"],r.stateType]]),oe,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"finalState","onUpdate:modelValue":t[21]||(t[21]=function(e){return r.stateType=e})},null,512),[[a["l"],r.stateType]]),ce,Object(a["n"])(Object(a["e"])("input",{type:"radio",name:"stateType",value:"regularState","onUpdate:modelValue":t[22]||(t[22]=function(e){return r.stateType=e}),checked:""},null,512),[[a["l"],r.stateType]]),le,Object(a["e"])("span",{onClick:t[23]||(t[23]=function(e){return i.selColor()}),style:{"margin-left":"70px"}},[Object(a["e"])("i",fe,null,512)])],512),Object(a["e"])("div",ue,[de,Object(a["e"])("input",{autofocus:"autofocus",class:"modal-enter",ref:"transName",placeholder:"".concat(r.transSrc,"=>T=>").concat(r.transDst),type:"text"},null,8,["placeholder"]),pe,he,Object(a["e"])("input",be,null,512),Oe,ye,Object(a["n"])(Object(a["e"])("select",{id:"fromState","onUpdate:modelValue":t[24]||(t[24]=function(e){return r.transSrc=e}),class:"modal-enter"},[(Object(a["f"])(!0),Object(a["c"])(a["a"],null,Object(a["i"])(r.srcOptions,(function(e){return Object(a["f"])(),Object(a["c"])("option",{key:e.id,value:e.value},Object(a["k"])(e.text),9,["value"])})),128))],512),[[a["m"],r.transSrc]]),me,ge,Object(a["n"])(Object(a["e"])("select",{id:"toState","onUpdate:modelValue":t[25]||(t[25]=function(e){return r.transDst=e}),class:"modal-enter"},[(Object(a["f"])(!0),Object(a["c"])(a["a"],null,Object(a["i"])(r.dstOptions,(function(e){return Object(a["f"])(),Object(a["c"])("option",{key:e.id,value:e.value},Object(a["k"])(e.text),9,["value"])})),128))],512),[[a["m"],r.transDst]]),je,Object(a["e"])("button",{id:"confirmTrans",class:"modal-enter",onClick:t[26]||(t[26]=function(e){return i.newTrans()})},"Confirm")],512),Object(a["e"])("div",ve,[Object(a["e"])("input",we,null,512),Object(a["e"])("button",{id:"confirmAction",class:"modal-enter",onClick:t[27]||(t[27]=function(e){return i.newAction()})},"Confirm")],512)])]),Object(a["e"])("input",{id:"projectinput",ref:"projectinput",onChange:t[28]||(t[28]=function(e){return i.onLoad(e)}),type:"file",style:{display:"none"}},null,544)],512)])})),Se=n("3835"),xe=n("1da1"),Ne=(n("96cf"),n("a434"),n("d3b7"),n("b0c0"),n("159b"),n("ddb0"),n("4fad"),n("8ae0")),Te=(n("1646"),n("d4ec")),Ce=n("bee2"),Je=(n("7db0"),function(){function e(t,n){Object(Te["a"])(this,e),this.pattern=n?{name:t,func:n}:{name:t}}return Object(Ce["a"])(e,[{key:"get",value:function(){return this.pattern}},{key:"addfunc",value:function(e){this.pattern.func=e}}]),e}()),Pe=function(){function e(t,n,a){Object(Te["a"])(this,e),this.pattern=a||{key:t,nextstatename:n,triggers:[],effects:[]}}return Object(Ce["a"])(e,[{key:"get",value:function(){return this.pattern}},{key:"addtrigger",value:function(e,t){this.pattern.triggers.push(new Je(e,t).get())}},{key:"addeffect",value:function(e,t){this.pattern.effects.push(new Je(e,t).get())}}]),e}(),Me=function(){function e(t,n,a){switch(Object(Te["a"])(this,e),this.transDict={},this.pattern={key:t,name:n},a){case"initialState":this.pattern.key="init",this.pattern.exits=[],this.pattern.transitions=[];break;case"finalState":this.pattern.entries=[];break;default:this.pattern.entries=[],this.pattern.stays=[],this.pattern.exits=[],this.pattern.transitions=[]}}return Object(Ce["a"])(e,[{key:"get",value:function(){return this.pattern}},{key:"setsuperstate",value:function(e){this.pattern.superstate={link:e}}},{key:"addentry",value:function(e,t){if(this.pattern.hasOwnProperty("entries")){var n=this.pattern.entries.find((function(t){return t.name==e}));if(void 0===n){var a=new Je(e,t);return this.pattern.entries.push(a.get()),a}return n.func=t,null}return null}},{key:"addexit",value:function(e,t){if(this.pattern.hasOwnProperty("exits")){var n=new Je(e,t);return this.pattern.exits.push(n.get()),n}return null}},{key:"addstay",value:function(e,t){if(this.pattern.hasOwnProperty("stays")){var n=new Je(e,t);return this.pattern.stays.push(n.get()),n}return null}},{key:"addtrans",value:function(e,t,n){if(this.pattern.hasOwnProperty("transitions")){var a=new Pe(e,t,n);return this.pattern.transitions.push(a.get()),this.transDict[e]=a,a}return null}},{key:"deltrans",value:function(e){if(this.pattern.hasOwnProperty("transitions"))for(var t=this.get().transitions,n=0;n<t.length;n++){var a=t[n];if(a.key===e)return t.splice(n,1),this.transDict.hasOwnProperty(e)&&delete this.transDict[e],!0}return!1}},{key:"clonetrans",value:function(e){if(this.pattern.hasOwnProperty("transitions")){var t=new Pe("","",JSON.parse(JSON.stringify(e)));return this.pattern.transitions.push(t.get()),t}return null}}]),e}(),Ae=function(){function e(t,n){Object(Te["a"])(this,e),this.pattern={id:t,type:"FSM",prj:n,complete:!1,start:{},stop:{},countstates:0,states:{}},this.statesDict={},this.stroke=["#d0c4f4","#f46b6d","#5d8dbe","#F4D03F","#66bc84","#e6b362","#80c5e2"]}return Object(Ce["a"])(e,[{key:"reset",value:function(){this.pattern.start={},this.pattern.stop={},this.pattern.countstates=0,this.pattern.states={},this.statesDict={}}},{key:"get",value:function(){return this.pattern}},{key:"addstate",value:function(e,t,n){var a=new Me(e,t,n);return this.pattern.states[e]=a.get(),this.pattern.countstates++,this.statesDict[e]=a,a}},{key:"delstate",value:function(e){this.pattern.states.hasOwnProperty(e)&&(delete this.pattern.states[e],this.pattern.countstates--,this.statesDict.hasOwnProperty(e)&&delete this.statesDict[e])}},{key:"addstart",value:function(e,t){this.pattern.start=new Je(e,t).get()}},{key:"addstop",value:function(e,t){this.pattern.stop=new Je(e,t).get()}},{key:"genColor",value:function(){for(var e="0123456789ABCDEF",t="#",n=0;n<6;n++)t+=e[Math.floor(16*Math.random())];return t}}]),e}(),De=n("21a6"),Re=n.n(De),$e=function(){function e(t){Object(Te["a"])(this,e),this._prjname_=t||"project",this._extension_="dafsm"}return Object(Ce["a"])(e,[{key:"read",value:function(e,t){var n=new FileReader;n.readAsText(e),n.onload=function(){console.log(n.result),t&&t(n.result)},n.onerror=function(){console.log(n.error)}}},{key:"save",value:function(e,t){var n=t||"".concat(this._prjname_,".").concat(this._extension_),a=new File([e],n,{type:"text/plain;charset=utf-8"});Re.a.saveAs(a)}}]),e}(),Ee={name:"Graph",data:function(){return{uml:Ne["b"].uml,selected:null,fsaJSON:new Ae("tst","prj"),fsaPROJ:new $e("myproj"),stateType:"regularState",transSrc:void 0,srcOptions:[],transDst:void 0,dstOptions:[]}},created:function(){var e=this;this.graph=new Ne["a"].Graph({},{cellNamespace:Ne["b"]}),this.graph.on("remove",(function(t){var n=e.fsaJSON.get();switch(t.fsa.type){case"trans":var a=t.fsa.owner.pattern,s=t.fsa.item.get().key;if(console.log("Remove from Owner ".concat(JSON.stringify(t.fsa.owner)," Transition: ").concat(JSON.stringify(t.fsa.item.get()))),t.fsa.owner.deltrans(t.fsa.item.get().key),n.states.hasOwnProperty(a.key)&&n.states[a.key].hasOwnProperty("transitions"))for(var r=n.states[a.key].transitions,i=0;i<r.length;i++){var o=r[i];o.key===s&&r.splice(i,1)}break;case"state":var c=t.fsa.item.get().key;console.log("Remove State: ",t.fsa.item.get()),e.fsaJSON.delstate(c),n.states.hasOwnProperty(c)&&delete n.states[c];break}})),this.graph.on("change:source",(function(t){t.attributes.source.id&&e.changeTransSrc(t)})),this.graph.on("change:target",(function(t){e.changeTransDst(t)}))},mounted:function(){var e=this,t=this;this.paper=new Ne["a"].Paper({el:this.$refs.joint,width:this.$refs.joint.clientWidth,height:this.$refs.joint.clientHeight,gridSize:1,model:this.graph,cellViewNamespace:Ne["b"],snapLabels:!0,interactive:{linkMove:!0,labelMove:!0,arrowheadMove:!0,vertexMove:!0,vertexAdd:!0,vertexRemove:!0,useLinkTools:!0}}),this.paper.on("cell:pointerdown",(function(n){t.selected&&t.selected.attr({rect:{fill:"rgba(48, 208, 198, 0.1)"},text:{fill:"black","font-size":15}}),n.model.attr({rect:{fill:"yellow"},text:{fill:"black","font-size":15}}),t.selected=n.model,"state"===t.selected.fsa.type?(e.$refs.more.innerText="State",t.showhide([".state"],[".paper",".trans"]),"init"===t.selected.fsa.item.pattern.key&&t.showhide([],[".init"]),"final"===t.selected.fsa.item.pattern.key&&t.showhide([],[".final"])):"trans"===t.selected.fsa.type?(e.$refs.more.innerText="Trans",t.showhide([".trans"],[".paper",".state"])):t.showhide([],[".paper",".state",".trans"]),console.log("selected "+t.selected.fsa.type,t.selected.fsa.item)})),this.paper.on("blank:pointerdown",(function(){t.selected&&(t.selected.attr({rect:{fill:"rgba(48, 208, 198, 0.1)"},text:{fill:"black","font-size":15}}),t.selected=null,t.showhide([".paper"],[".state",".trans"]),console.log("Reset All"),e.$refs.more.innerText="Paper")})),this.paper.on("cell:pointerclick",(function(e,t,n,a){console.log("cell:pointerclick - x[".concat(n,"], y[").concat(a,"]"))})),this.paper.on("cell:pointerdblclick",(function(e){console.log("Show State:",e.model.fsa.item.get())})),this.paper.on("element:contextmenu",(function(e){console.log("Rigth Click Context Menu:")}))},watch:{},computed:{},methods:{graphExport:function(){return Object(xe["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},execJSON:function(){var e=this;return Object(xe["a"])(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="test",t.next=3,fetch("/code/json/".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.fsaJSON.get())});case 3:return a=t.sent,t.next=6,a.json();case 6:s=t.sent,console.log("Execute JSON:",s),e.fsaPROJ.save(JSON.stringify(s),"exec.json");case 9:case"end":return t.stop()}}),t)})))()},nodejsCODE:function(){var e=this;return Object(xe["a"])(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="test",t.next=3,fetch("/code/nodejs/".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.fsaJSON.get())});case 3:return a=t.sent,t.next=6,a.text();case 6:s=t.sent,console.log("Node.js code template:",s),e.fsaPROJ.save(s,"code.js");case 9:case"end":return t.stop()}}),t)})))()},selColor:function(){var e=this.fsaJSON.genColor();console.log("Color:",e),this.$refs.palette.style.color=e},genColor:function(){return this.fsaJSON.genColor()},newGraph:function(){this.graph.clear(),this.fsaJSON.reset(),console.log("Start new graph")},openGraph:function(){this.$refs.projectinput.click()},onLoad:function(e){var t=this,n=e.target.files[0];console.log("Load Project File: ".concat(n.name,", size: ").concat(n.size)),this.fsaPROJ.read(n,(function(e){var n=JSON.parse(e);console.debug("Read Project: ",n),t.restoreGraph(n.states)}))},saveGraph:function(){this.fsaPROJ.save(JSON.stringify(this.fsaJSON.get()))},getSelectedItem:function(){return this.selected?{type:this.selected.fsa.type,name:this.selected.fsa.item.pattern.key}:null},sellRemove:function(){this.selected&&this.selected.remove()},showhide:function(e,t){e.forEach((function(e,t,n){var a=document.querySelectorAll(e);for(t=0;t<a.length;t++)a[t].style.display="block"})),t.forEach((function(e,t,n){var a=document.querySelectorAll(e);for(t=0;t<a.length;t++)a[t].style.display="none"}))},showDAFSM:function(){console.log("DAFSM:",this.fsaJSON.get());var e=window.open("_blank");e.document.write(JSON.stringify(this.fsaJSON.get()))},showModal:function(e,t){this.$refs.dialog.style.display="block",this.$refs[e].style.display="block",this.actionType=t,this.updateStateList()},hideModal:function(){this.$refs["State"].style.display="none",this.$refs["Trans"].style.display="none",this.$refs["Action"].style.display="none",this.$refs.dialog.style.display="none"},updateStateList:function(){for(var e in this.srcOptions=[],this.dstOptions=[],this.fsaJSON.get().states)console.log("Update state list",e),this.srcOptions.push({id:e,text:e,value:e}),this.dstOptions.push({id:e,text:e,value:e})},newAction:function(){var e=this.$refs.actionName.value;this.addAction(this.actionType,e),this.hideModal()},newState:function(){var e=this.stateType,t="initialState"===this.stateType?"init":"finalState"===this.stateType?"final":this.$refs.stateName.value;if(console.log("New State: ".concat(t," [").concat(e,"]")),this.fsaJSON.get().states[t])return this.$refs.stateName.value="",this.$refs.stateName.setAttribute("placeholder","state[ "+t+"] exist - choose other name"),void console.log("state[ "+t+"] exist - choose other name");this.makeState(e,t),this.hideModal()},makeState:function(e,t){var n=this.uml,a=this.fsaJSON.get(),s=null,r=null,i=10*a.countstates;switch(e){case"initialState":s=new n.StartState({position:{x:150,y:20},size:{width:30,height:30},attrs:{circle:{fill:"#4b4a67",stroke:"none"}}}),r=this.fsaJSON.addstate("init","init",e),a["states"]["init"]=r.pattern;break;case"finalState":s=new n.EndState({position:{x:750,y:550},size:{width:30,height:30},attrs:{".outer":{stroke:"#4b4a67","stroke-width":2},".inner":{fill:"#4b4a67"}}}),r=this.fsaJSON.addstate("final","final",e),a["states"]["final"]=r.pattern;break;default:var o=this.$refs.palette.style.color;s=new n.State({position:{x:500+i,y:50+i},size:{width:150,height:80},name:t,events:['{"entries":0}','{"stays":0}','{"exits":0}'],attrs:{".uml-state-body":{fill:"rgba(48, 208, 198, 0.1)",stroke:o,"stroke-width":3},".uml-state-separator":{stroke:o}}}),r=this.fsaJSON.addstate(t,t,e),a["states"][t]=r.pattern}r.get().model=s,s.fsa={type:"state",item:r},this.graph.addCell(s),console.log("".concat(t,"[").concat(s.id,"]"),s)},newTrans:function(){var e=void 0;if(!this.transSrc||!this.transDst)return this.$refs.transName.value="",this.$refs.transName.setAttribute("placeholder","please select transition source & destination"),void console.log("please fill all fields and select side");this.transSrc===this.transDst&&(e=[{x:513,y:309},{x:637,y:308},{x:636,y:221}]);var t=this.$refs.transName.value,n=this.$refs.effectName.value;this.makeTrans(this.transSrc,this.transDst,t,n,e),this.hideModal()},makeTrans:function(e,t,n,a,s){var r=this.uml,i=this.fsaJSON.get(),o="".concat(e,"=>[").concat(n,"/").concat(a,"]=>").concat(t),c=i.states[e],l=i.states[t],f=n?"".concat(n,"/").concat(a):o,u=new r.Transition({source:{id:c.model.id},target:{id:l.model.id},attrs:{".connection":{fill:"none","stroke-linejoin":"round","stroke-width":"2",stroke:"init"===e?"#4b4a67":c.model.attributes.attrs[".uml-state-body"].stroke},".marker-arrowheads":{display:"none"}},labels:[{position:{distance:.5,offset:f.indexOf("\n")>-1||1===f.length?0:10,args:{keepGradient:!0,ensureLegibility:!0}},attrs:{text:{text:f,fontWeight:"bold"}}}],vertices:s||[]}),d=c.model.fsa.item.addtrans(o,l.key);n&&d.addtrigger(n,""),a&&d.addeffect(a,""),d.get().model=u,u.fsa={type:"trans",item:d,owner:c.model.fsa.item},this.graph.addCell(u),console.log("".concat(e,"[").concat(c.model.id,"] => ").concat(t,"[").concat(l.model.id,"]"),u)},addAction:function(e,t,n){var a=this.getSelectedItem();if(a){var s=this.selected.fsa.item;switch(a.type){case"state":var r=this.selected.get("events");switch(e){case"entries":if(r){var i=JSON.parse(r[0]);i.entries++,this.selected.set("events",[JSON.stringify(i),r[1],r[2]])}s.addentry(t,n||"return");break;case"stays":if(r){var o=JSON.parse(r[1]);o.stays++,this.selected.set("events",[r[0],JSON.stringify(o),r[2]])}s.addstay(t,n||"return");break;case"exits":if(r){var c=JSON.parse(r[2]);c.exits++,this.selected.set("events",[r[0],r[1],JSON.stringify(c)])}s.addexit(t,n||"return");break}break;case"trans":switch(e){case"triggers":s.addtrigger(t,n||"return true");break;case"effects":s.addeffect(t,n||"return");break}break}}},changeTransDst:function(e){if(e.attributes.target.id){var t=e.attributes.target.id,n=e.graph.getCell(t);e.fsa.item.pattern.key="T:".concat(e.fsa.owner.pattern.key,"=>").concat(n.fsa.item.pattern.key),e.fsa.item.pattern.nextstatename=n.fsa.item.pattern.key,console.log("target of the link changed to ".concat(e.fsa.item.pattern.nextstatename,":"),e,n),console.log("updated FSA",this.get().states)}},changeTransSrc:function(e){var t=e.attributes.source.id,n=e.graph.getCell(t),a=e.fsa.owner.pattern.key,s=n.fsa.item.pattern.key;if(a!==s){var r=this.get().states[a],i=this.get().states[s],o=e.fsa.item.pattern.key,c=r.model.fsa.item.deltrans(o);Array.isArray(c)?(c=c[0],c.key="T:".concat(s,"=>").concat(e.fsa.item.pattern.nextstatename),i.model.fsa.item.clonetrans(c),e.fsa.item.pattern.key=c.key,e.fsa.owner=i.model.fsa.item,console.log("source of the link changed and updated FSA",this.get().states)):(e.remove(),console.log("source of the link changed failed, was deleted",this.get().states))}},restoreState:function(e){var t=this.uml,n={StartState:function(e,n){var s=new t.StartState(e.model),r=n.fsaJSON.addstate("init",e.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s},EndState:function(e,n){var s=new t.EndState(e.model),r=n.fsaJSON.addstate("final",e.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s},State:function(e,n){var s=new t.State(e.model),r=n.fsaJSON.addstate(e.key,e.name,a);return r.get().model=s,s.fsa={type:"state",item:r},s}},a=e.model.type.substring(e.model.type.indexOf(".")+1);console.log("Restore State: ",e.model),this.graph.addCell(n[a](e,this))},restoreTrans:function(e,t,n,a){var s=this.uml,r=new s.Transition(e),i=t.addtrans(a,n);return i.get().model=r,r.fsa={type:"trans",item:i,owner:t},console.log("Restore Trans: ",e),this.graph.addCell(r),i},restoreGraph:function(e){var t=this;if(e instanceof Object){for(var n=0,a=Object.entries(e);n<a.length;n++){var s=Object(Se["a"])(a[n],2),r=(s[0],s[1]);r.hasOwnProperty("model")&&this.restoreState(r)}for(var i=function(){var e=Object(Se["a"])(c[o],2),n=(e[0],e[1]);n&&n.hasOwnProperty("transitions")&&n.transitions.forEach((function(e){var a=t.fsaJSON.statesDict[n.key],s=a.addtrans(e.key,e.nextstatename,e);if(e.hasOwnProperty("model")){var r=new t.uml.Transition(e.model);r.fsa={type:"trans",item:s,owner:a},t.graph.addCell(r)}}))},o=0,c=Object.entries(e);o<c.length;o++)i()}else console.warn("Cannon Restore old style format")}}};n("3cde");Ee.render=ke,Ee.__scopeId="data-v-d4b613a0";var _e=Ee,Ge={name:"App",components:{Graph:_e}};n("077d");Ge.render=r;var Fe=Ge;Object(a["b"])(Fe).mount("#app")},"7c2c":function(e,t,n){}});
//# sourceMappingURL=app.7dc4925e.js.map